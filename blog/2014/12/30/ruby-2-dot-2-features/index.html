

<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Ruby 2.2.0 Features - @vishnuatrai</title>
	<meta name="author" content="vishnuatrai.in">

	
	<meta name="description" content="Ruby 2.2.0 Features">
	<meta name="keywords" content="Ruby, Ruby 2.2">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="@vishnuatrai" type="application/atom+xml">
	
	<link rel="canonical" href="http://vishnuatrai.in/blog/2014/12/30/ruby-2-dot-2-features/">
  <link href="/favicon.gif" rel="shortcut icon" type="image/x-icon" >
  <link rel="icon" href="/favicon.gif" type="image/x-icon">

	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/about">About</a></li>
  <li><a onclick="javascript:void(0);" id="search-blog-lnk" style='cursor:move;'>Search</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<div class="profile-container">
  <div class="profilepic">
    <script src="/javascripts/md5.js"></script>
    <script type="text/javascript">
$(function(){
  $('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5("vishnu.atrai@gmail.com") + "?s=160' alt='Profile Picture' style='width: 160px;' />");
});
    </script>
  </div>
  <hgroup>
  <h1 class="site-title"><a href="/">@vishnuatrai</a></h1>
  
  <p class="site-subtitle">Ruby on Rails contributor developer</p>
  
  </hgroup>
  
<hgroup>
  <nav id="sub-nav">
    <div class="social" style="margin-bottom:60px; margin-right:0px;">
        
      
        <a class="google" href="https://plus.google.com/102433220410072726105" rel="author" title="Google+">Google</a>
        

      
        <a class="twitter" href="http://twitter.com/vishnuatrai" title="Twitter">Twitter</a>
      
      
        <a class="github" href="https://github.com/vishnuatrai" title="GitHub">GitHub</a>
      
      
      
        <a class="linkedin" href="http://www.linkedin.com/in/vishnuatrai">LinkedIn</a>
      
      
      
      
      
        <a class="rss" href="/atom.xml" title="RSS" target='_blank'>RSS</a>
      
    </div>  
  </nav>
</hgroup>

<hgroup>
 <p class="site-subtitle" style="font-size:10px;">
  Copyright &copy; 2019 - vishnuatrai.in 
  <br />
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
 </p>
 </hgroup>


</div>
</header>
			</div>
		</div>
		<div class="mid-col">
			
				
			
      <div class="mid-col-container">
        <div id="bloag-search" style="display:none;">
          <gcse:search></gcse:search>
        </div>
				<div id="content" class="article-inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  
	<h1 class="title" itemprop="name">Ruby 2.2.0 Features</h1>
  








  



  <div class="post-date"><time datetime="2014-12-30T17:53:04+05:30" data-updated="true" itemprop="datePublished">Dec 30<span>th</span>, 2014</time></div>
	<div class="entry-content" itemprop="articleBody"><h3>1) Incremental and Symbol GC (RIncGC)</h3>

<p>Ruby 2.2.0 release includes several grabage collection (GC) improvements. Symbols are now garbage collectable.</p>

<p>Following the introduction of generational garbage collection in Ruby 2.1.0, which markedly improved the GC throughput, Ruby maintainers continue to introduce important changes in this space. The generational GC (RGenGC) classifies objects into generations, on the assumption that most objects die young. <!--more--> This assumption allows for high throughput and low pause time on younger objects, because older objects are only evaluated for deletion when there is no memory. But this means that older objects still suffer from high pause time.</p>

<p>The incremental GC (RIncGC), built on top of the generational GC, aims to cut that pause time while maintaining the same throughput. It achieves the shorter pause time by interleaving the mark phase, where objects are marked for GC, with Ruby&rsquo;s regular execution. Before Ruby 2.2.0, the mark phase was done in one big step.</p>

<h3>2) Rails 5.0 support</h3>

<p>Rails 5.0 will target Ruby 2.2+ exclusively. There are a bunch of optimizations coming in Ruby 2.2 that are going to be very nice, but most importantly for Rails, symbols are going to be garbage collected. This means we can shed a lot of weight related to juggling strings when we accept input from the outside world. It also means that we can convert fully to keyword arguments and all the other good stuff from the latest Ruby.</p>

<h3>3) Binding#local_variables</h3>

<p>To know the local variables defined in a scope use <code>binding.local_variables</code> that will give all variables in use.</p>

<pre><code>def m1(a, b)
  puts binding.local_variables
  c = a + b
  puts binding.local_variables
  c
end

irb(main):001&gt; m1(2,3)
[:a, :b, :c]
[:a, :b, :c]
=&gt;5
</code></pre>

<h3>4) Binding#receiver</h3>

<p>Ruby 2.2 provides a way to know which object is receiving the method call using <code>binding.receiver</code> method</p>

<pre><code>class Amimal
  def self.walk
    puts 'walk'
    binding.receiver
  end 
end

irb(main):001&gt; Amimal.walk
walk
=&gt;Animal

class Dog &lt; Animal
end 

irb(main):002&gt; Dog.walk
walk
=&gt;Dog
</code></pre>

<h3>5) Enumerable#slice_after</h3>

<p>This method is a complement to the existing <code>slice_before</code> method.</p>

<p>As the name suggests, <code>slice_before</code> is used to slice and dice enumerables. Given a way to match an element in the enumerable, it will find a match and cut it apart just prior to the match.</p>

<pre><code>irb(main):001&gt;[1, 'a', 2, 'b', 'c', 3, 'd', 'e', 'f'].slice_before { |e| e.is_a?(Integer) }.to_a
=&gt;[[1, "a"], [2, "b", "c"], [3, "d", "e", "f"]]
</code></pre>

<p><code>slice_after</code> does slices after instead:</p>

<pre><code>irb(main):002&gt;[1, 'a', 2, 'b', 'c', 3, 'd', 'e', 'f'].slice_after(Integer).to_a
=&gt;[[1], ["a", 2], ["b", "c", 3], ["d", "e", "f"]]
</code></pre>

<h3>6) Enumerable#slice_when</h3>

<p>A particularly fun addition is <code>slice_when</code>. Unlike <code>slice_after</code>, this method only accepts a block. It walks an enumerable, passing pairs of elements to the block. When the block returns <code>true</code>, the enumerable is sliced between the pair of elements:</p>

<pre><code>irb(main):001&gt;[1, 3, 4, 5, 7, 8, 9, 10, 12].slice_when { |a, b| a + 1 != b }.to_a
=&gt;[[1], [3, 4, 5], [7, 8, 9, 10], [12]]
</code></pre>

<h3>7) Float#next_float, Float#prev_float</h3>

<p>These functions return the next or previous representable float. Note the word “representable” in that sentence, not all floats can be represented.</p>

<pre><code>irb(main):001&gt;1.0.next_float
=&gt;1.0000000000000002

irb(main):002&gt;1.0.prev_float
=&gt;0.9999999999999999
</code></pre>

<h3>8) Kernel#itself</h3>

<p>Ruby went out and got itself an identity method. For those not familiar, an identity method returns the object it’s called on:</p>

<pre><code>irb(main):001&gt;1.itself
=&gt;1

irb(main):002&gt;[2, 3, 3, 1, 2, 3, 3, 1, 1, 2].group_by(&amp;:itself)
=&gt;{2=&gt;[2, 2, 2], 3=&gt;[3, 3, 3, 3], 1=&gt;[1, 1, 1]}
</code></pre>

<h3>8) Method#curry</h3>

<p>You might not have realized that Ruby is capable of currying and partial application. In the past, you could only call <code>curry</code> on a <code>Proc</code>. This same power is now available to you on <code>Method</code>.</p>

<pre><code>def sum(*args)
  args.reduce(:+)
end 

irb(main):001&gt;inc = method(:sum).curry(2).(1)
=&gt;#&lt;Proc:0x007fff322d7420 (lambda)&gt;
irb(main):002&gt;inc.(3)
=&gt;4
</code></pre>

<h3>9) Method#super_method</h3>

<p>Calling <code>super_method</code> returns the method that you would get if you called <code>super</code>. If the method has no parent, it returns <code>nil</code>.</p>

<pre><code>class Cat
  def speak
    'meow'
  end
end

class Tiger &lt; Cat
  def speak
    'roar'
  end
end

irb(main):001&gt;Tiger.new.method('speak')
=&gt;#&lt;Method: Tiger#speak&gt; 
irb(main):002&gt;Tiger.new.method('speak').super_method
=&gt;#&lt;Method: Cat#speak&gt;
irb(main):002&gt;Cat.new.method('speak').super_method
=&gt;nil
</code></pre>

<h3>10) Quoted symbol keys in hashes with a trailing colon</h3>

<p>Ruby 2.2 lets you create quoted symbol keys in hashes with a trailing colon:</p>

<pre><code>irb(main):001&gt;{ 'programming-language': :ruby }
</code></pre>

<h3>References</h3>

<p><a href="https://github.com/ruby/ruby/blob/v2_2_0/NEWS">https://github.com/ruby/ruby/blob/v2_2_0/NEWS</a></p>

<p><a href="https://www.ruby-lang.org/en/news/2014/12/25/ruby-2-2-0-released/">https://www.ruby-lang.org/en/news/2014/12/25/ruby-2-2-0-released/</a></p>

<p><a href="http://www.sitepoint.com/new-methods-ruby-2-2/">http://www.sitepoint.com/new-methods-ruby-2-2/</a></p>
</div>

</article>

	<div class="share">
    <div class="share_icon_group addthis_toolbox addthis_default_style addthis_32x32_style">
        
            <a class="share_icon addthis_button_preferred_1"></a>
        
        
            <a class="share_icon addthis_button_preferred_2" fb:like:layout="button_count"></a>
        
        
            <a class="share_icon addthis_button_preferred_3" g:plusone:size="medium"></a>
        
        <a class="share_icon addthis_button_preferred_4"></a>
    </div>
    <script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
			</div>
			<footer id="footer" class="inner">
</footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'cutthecuttingedge';
      
        

        // var disqus_developer = 1;
        var disqus_identifier = 'http://vishnuatrai.in/blog/2014/12/30/ruby-2-dot-2-features/';

        var disqus_url = 'http://vishnuatrai.in/blog/2014/12/30/ruby-2-dot-2-features/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-18733388-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    
    (function() {
      var cx = '003479435450341944083:wkvxmvwzl1m';
      var gcse = document.createElement('script');
      gcse.type = 'text/javascript';
      gcse.async = true;
      gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
      var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
    })();
    $(document).ready(function(){
      $('#search-blog-lnk').click(function(e){ 
         $('#bloag-search').toggle(); 
         $('#bloag-search').css( {'top':e.pageY-50,'left': (e.pageX), 'position':'absolute', 'border':'1px solid black', 'padding':'0px'} );
      });

      $('#bloag-search').css('z-index','10000');
      $('#content').click(function(){  $('#bloag-search').hide();  });
      $("#bloag-search").on('click', '.gsc-clear-button', 
        function(){ $('#bloag-search').hide();
      });

    });
  </script>




		</div>
	</div>
</body>
</html>
