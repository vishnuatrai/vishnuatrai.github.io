

<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Kubernetes - Secrets vs ConfigMaps - @vishnuatrai</title>
	<meta name="author" content="vishnuatrai.in">

	
	<meta name="description" content="Kubernetes - Secrets vs ConfigMaps">
	<meta name="keywords" content="Kubernetes, Secrets, ConfigMaps">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="@vishnuatrai" type="application/atom+xml">
	
	<link rel="canonical" href="http://vishnuatrai.in/blog/2018/08/16/kubernetes-secrets-vs-configmaps/">
  <link href="/favicon.gif" rel="shortcut icon" type="image/x-icon" >
  <link rel="icon" href="/favicon.gif" type="image/x-icon">

	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/about">About</a></li>
  <li><a onclick="javascript:void(0);" id="search-blog-lnk" style='cursor:move;'>Search</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<div class="profile-container">
  <div class="profilepic">
    <script src="/javascripts/md5.js"></script>
    <script type="text/javascript">
$(function(){
  $('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5("vishnu.atrai@gmail.com") + "?s=160' alt='Profile Picture' style='width: 160px;' />");
});
    </script>
  </div>
  <hgroup>
  <h1 class="site-title"><a href="/">@vishnuatrai</a></h1>
  
  <p class="site-subtitle">Java, Spring Boot, Ruby on Rails contributor developer</p>
  
  </hgroup>
  
<hgroup>
  <nav id="sub-nav">
    <div class="social" style="margin-bottom:60px; margin-right:0px;">
        
        

      
        <a class="twitter" href="http://twitter.com/vishnuatrai" title="Twitter">Twitter</a>
      
      
        <a class="github" href="https://github.com/vishnuatrai" title="GitHub">GitHub</a>
      
      
      
        <a class="linkedin" href="http://www.linkedin.com/in/vishnuatrai">LinkedIn</a>
      
      
      
      
      
        <a class="rss" href="/atom.xml" title="RSS" target='_blank'>RSS</a>
      
    </div>  
  </nav>
</hgroup>

<hgroup>
 <p class="site-subtitle" style="font-size:10px;">
  Copyright &copy; 2020 - vishnuatrai.in 
  <br />
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
 </p>
 </hgroup>


</div>
</header>
			</div>
		</div>
		<div class="mid-col">
			
				
			
      <div class="mid-col-container">
        <div id="bloag-search" style="display:none;">
          <gcse:search></gcse:search>
        </div>
				<div id="content" class="article-inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  
	<h1 class="title" itemprop="name">Kubernetes - Secrets vs ConfigMaps</h1>
  








  



  <div class="post-date"><time datetime="2018-08-16T16:28:34+05:30" data-updated="true" itemprop="datePublished">Aug 16<span>th</span>, 2018</time></div>
	<div class="entry-content" itemprop="articleBody"><h3>Secrets</h3>

<p>Serets are k8s object to manage small amount of sensitive data like password, keys and tokens with less than 1mb size. Secrets encoded and stored inside k8s master etcd data store. Since Secrets will be created outside of pods and containers, these can be used any number of times.</p>

<h4>1. Create <code>secret</code> using <code>kubectl</code><!--more--></h4>

<pre><code>#syntax
kubectl create secret &lt;type of secret (generic)&gt; &lt;name of secret&gt; &lt;data from-file|from-literal&gt;
echo -n 'admin' &gt; ./username.txt
echo -n '1f2d1e2e67df' &gt; ./password.txt
kubectl create secret generic db-user-pass --from-file=./username.txt --from-file=./password.txt
kubectl create secret generic dev-db-secret --from-literal=username=user --from-literal=password='S!B\*d$zDsb='
</code></pre>

<h4>2. Create <code>Secret</code> using yaml menifesto files</h4>

<pre><code>#sample yaml menifesto secret.yaml file 
apiVersion: v1
kind: Secret
metadata:
    name: mysecret
type: Opaque
data:
    username: appuser
    password: MWYyZDFlMmU2N2Rm
</code></pre>

<p>create using kubectl apply</p>

<pre><code>kubectl apply -f ./secret.yaml
</code></pre>

<h4>Deploy Secrets in Pods</h4>

<h4>1. Through Volumes</h4>

<pre><code>#sample pod manifesto yaml file
apiVersion: v1
kind: Pod
metadata:
    name: nginx
spec:
    containers:
    - name: nginx
      image: nginx
      volumeMounts:
      - name: secret-volumn
        mountPath: /etc/secret
        readOnly: true
    volumes:
    - name: secret-volumn
      secret:
        secretName: mysecret
</code></pre>

<p>Add a volume section with type <code>secret</code> and with <code>secretName</code>(ie. mysecret already created) and then mount the secret volumn to container target location that is similar to mounting any other volumes.</p>

<h4>2. Through environment variables</h4>

<pre><code>#sample pod manifesto yaml file
apiVersion: v1
kind: Pod
metadata:
    name: nginx
spec:
    containers:
    - name: nginx
      image: nginx
      env:
      - name: SECRET_USERNAME
        valueFrom:
            secretKeyRef:
                name: mysecret
                key: username
      - name: SECRET_PASSWORD
        valueFrom:
            secretKeyRef:
                name: mysecret
                key: password
</code></pre>

<p>Instead of volume mapping use environment variables and use secret(ie. mysecret) to assign values. Verify the environment variables.</p>

<pre><code>kubectl exec nginx env | grep SECRET
    =&gt; SECRET_PASSWORD=MWYyZDFlMmU2N2Rm
    =&gt; SECRET_USERNAME=appuser
</code></pre>

<h3>ConfigMaps</h3>

<p>ConfigMaps used to seperate container images and its custom configurations so that images are portable and can be run in any environment providing appropriate configuration. <code>ConfigMap</code> stores data in key, value format. If any configuration values are sensitive the use <code>Secret</code> instead <code>ConfigMap</code>. Its must to create <code>ConfigMap</code> before hand if we need to refer in pod spec.</p>

<h4>1. Create <code>configmap</code> using <code>kubectl</code><!--more--></h4>

<pre><code>#syntax
kubectl create configmap &lt;name of configmap&gt; &lt;data from-file|from-literal&gt;
path/to/config/file/application.yaml
path/to/config/file/application-prod.properties
kubectl create configmap app-config --from-file=path/to/config/file/
kubectl get configmaps app-config -o wide #list the content of properties and yml file configuration
kubectl create configmap custom-config --from-literal port=8080 --from-literal https=false
</code></pre>

<h4>2. Create <code>ConfigMap</code> using yaml menifesto files</h4>

<pre><code>#sample yaml menifesto configmap.yaml file 
apiVersion: v1
kind: ConfigMap
metadata:
    name: myconfig
type: Opaque
data:
    port: 8080
    https: false
</code></pre>

<p>create using kubectl apply</p>

<pre><code>kubectl apply -f ./configmap.yaml
</code></pre>

<h4>Deploy ConfigMaps in Pods</h4>

<h4>1. Through Volumes</h4>

<pre><code>#sample pod manifesto yaml file
apiVersion: v1
kind: Pod
metadata:
    name: nginx
spec:
    containers:
    - name: nginx
      image: nginx
      volumeMounts:
      - mountPath: /target/
        name: custom-config
    volumes:
    - name: custom-config
      configMap:
        name: app-config
        items:
        - key: application.yaml  
          path: application.yaml
        - key: application-prod.properties
          path: application-prod.properties
</code></pre>

<p>In <code>volumes</code> section <code>key</code> is file name created while configMap, <code>path</code> is target location where data will be present inside the pod.
in <code>volumeMounts</code> we provide the mountPath the target directory to mount the configMap volume.</p>

<h4>2. Through environment variables</h4>

<pre><code>#sample pod manifesto yaml file
apiVersion: v1
kind: Pod
metadata:
    name: nginx
spec:
    containers:
    - name: nginx
      image: nginx
      env:
      - name: CONFIG_PORT
        valueFrom:
            configMapKeyRef:
                name: myconfig
                key: port
</code></pre>

<p>Instead of volume mapping use environment variables and use configmap(ie. myconfig) to assign values. Verify the environment variables.</p>

<pre><code>kubectl exec nginx env | grep CONFIG
    =&gt; CONFIG_PORT=8080
</code></pre>
</div>

</article>

	<div class="share">
    <div class="share_icon_group addthis_toolbox addthis_default_style addthis_32x32_style">
        
            <a class="share_icon addthis_button_preferred_1"></a>
        
        
            <a class="share_icon addthis_button_preferred_2" fb:like:layout="button_count"></a>
        
        
        <a class="share_icon addthis_button_preferred_4"></a>
    </div>
    <script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
			</div>
			<footer id="footer" class="inner">
</footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'cutthecuttingedge';
      
        

        // var disqus_developer = 1;
        var disqus_identifier = 'http://vishnuatrai.in/blog/2018/08/16/kubernetes-secrets-vs-configmaps/';

        var disqus_url = 'http://vishnuatrai.in/blog/2018/08/16/kubernetes-secrets-vs-configmaps/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-18733388-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    
    (function() {
      var cx = '003479435450341944083:wkvxmvwzl1m';
      var gcse = document.createElement('script');
      gcse.type = 'text/javascript';
      gcse.async = true;
      gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
      var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
    })();
    $(document).ready(function(){
      $('#search-blog-lnk').click(function(e){ 
         $('#bloag-search').toggle(); 
         $('#bloag-search').css( {'top':e.pageY-50,'left': (e.pageX), 'position':'absolute', 'border':'1px solid black', 'padding':'0px'} );
      });

      $('#bloag-search').css('z-index','10000');
      $('#content').click(function(){  $('#bloag-search').hide();  });
      $("#bloag-search").on('click', '.gsc-clear-button', 
        function(){ $('#bloag-search').hide();
      });

    });
  </script>




		</div>
	</div>
</body>
</html>
